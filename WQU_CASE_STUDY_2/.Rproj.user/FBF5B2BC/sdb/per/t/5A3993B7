{
    "collab_server" : "",
    "contents" : "# Install the quantmod package\n# install.packages('quantmod')\n# install.packages('graphics')\n\n# Require the package quantmod\nrequire('quantmod')\nlibrary('graphics')\n# require('PortfolioAnalytics')\n# require('PerformanceAnalytics')\n\n# Set the Tickers for which the data needs to be fetched\nTickers <- c(\"MSFT\", \"GOOG\", \"FB\", \"AMZN\", \"CSCO\")\n\n# Get the 1 Year Data for each Ticker\nTicker.Data <- getSymbols(Symbols = Tickers,\n                          return.class = \"xts\",\n                          from = \"2016-03-19\",\n                          to = Sys.Date())\n\n# Set every ticker's Close Price\nMSFT.Adj <- Ad(MSFT)\nGOOG.Adj <- Ad(GOOG)\nFB.Adj <- Ad(FB)\nAMZN.Adj <- Ad(AMZN)\nCSCO.Adj <- Ad(CSCO)\n\n# Get the Monthly Return of for each Ticker\nMSFT.Monthly <- monthlyReturn(MSFT.Adj)\nGOOG.Monthly <- monthlyReturn(GOOG.Adj)\nFB.Monthly <- monthlyReturn(FB.Adj)\nAMZN.Monthly <- monthlyReturn(AMZN.Adj)\nCSCO.Monthly <- monthlyReturn(CSCO.Adj)\n\n# Create the Combined Portfolio\nNUMBER_OF_COMBOS = 3  # Constant Variable\nport <- combn(c(\"MSFT.Monthly\", \"GOOG.Monthly\", \"FB.Monthly\", \"AMZN.Monthly\", \"CSCO.Monthly\"), NUMBER_OF_COMBOS)\n\n# Construct Portfolio\nfor(i in 1:as.numeric(length(port) / NUMBER_OF_COMBOS)) {\n  assign(paste(\"portfolio\", i, sep=\"\"),rowMeans(merge(eval(as.name(port[1,i])), eval(as.name(port[2,i])), eval(as.name(port[3,i])))))\n}\n\n# Cumulative_Sum of All Portfolios\nfor(i in 1:as.numeric(length(port) / NUMBER_OF_COMBOS)){\n  assign(paste(\"portfolio_cumsum\", i, sep=\"\"), cumsum(eval(as.name(paste(\"portfolio\", i, sep=\"\")))))\n}\n\n# Set Colors\ncoloring = rainbow(as.numeric(length(port) / NUMBER_OF_COMBOS))\n\nplot(0, 0, xlim = c(1,13), ylim = c(-5,35),\n     xlab = \"Month\", ylab = \"Cumulative Monthly Return\", type = \"n\")\n# lines(c(portfolio_cumsum1 * 100, portfolio_cumsum2 * 100, portfolio_cumsum3 * 100, portfolio_cumsum4 * 100, portfolio_cumsum5 * 100,\n#      portfolio_cumsum6 * 100, portfolio_cumsum7 * 100, portfolio_cumsum8 * 100, portfolio_cumsum9 * 100, portfolio_cumsum10 * 100))\n\n# Calculate the mean, median, standard deviation and plot them\nfor(i in 1:as.numeric(length(port) / NUMBER_OF_COMBOS)){\n  assign(paste(\"mean_portfolio\", i, sep=\"\"), mean(eval(as.name(paste(\"portfolio\", i, sep=\"\")))))\n  assign(paste(\"median_portfolio\", i, sep=\"\"), median(eval(as.name(paste(\"portfolio\", i, sep=\"\")))))\n  assign(paste(\"std_portfolio\", i, sep=\"\"), sd(eval(as.name(paste(\"portfolio\", i, sep=\"\")))))\n}\n\nvariance_sum = sum(std_portfolio1 ** 2, std_portfolio2 ** 2, std_portfolio3 ** 2, std_portfolio4 ** 2, std_portfolio5 ** 2,\n                   std_portfolio6 ** 2, std_portfolio7 ** 2, std_portfolio8 ** 2, std_portfolio9 ** 2, std_portfolio10 ** 2)\n\n# Plot the lines on the graph\nfor(i in 1:length(coloring)) {\n  lines(eval(as.name(paste(\"portfolio_cumsum\", i ,sep=\"\"))) * 100, col = coloring[i])\n  points(eval(as.name(paste(\"mean_portfolio\", i ,sep=\"\"))) * 100, col = coloring[i])\n  text(1, 30 - 2 * i, \n       paste(\n         paste(\"portfolio\", i ,sep=\"\"), \n         'Monthy return stats:',\n         'Mean = ', format(round(eval(as.name(paste(\"mean_portfolio\", i ,sep=\"\"))) * 100, 2), nsmall = 2),\n         'Median = ', format(round(eval(as.name(paste(\"median_portfolio\", i ,sep=\"\"))) * 100, 2), nsmall = 2),\n         'SD = ', format(round(eval(as.name(paste(\"std_portfolio\", i ,sep=\"\"))) * 100, 2), nsmall = 2)\n       ),\n       cex=0.5)  \n}\n\nlegend(x = \"bottomright\", # location of legend within plot area\n       c(\"Portfolio1\", \"Portfolio2\", \"Portfolio3\",\"Portfolio4\", \"Portfolio5\",\n         \"Portfolio6\", \"Portfolio7\", \"Portfolio8\", \"Portfolio9\", \"Portfolio10\"),\n       col = coloring,\n       lwd = c(2, 2, 2),\n       cex = 0.4)\n\n# Plot the Histogram\nhist(portfolio1, breaks = 6, prob = TRUE)\nhist(portfolio2, breaks = 6, prob = TRUE)\nhist(portfolio3, breaks = 6, prob = TRUE)\nhist(portfolio4, breaks = 6, prob = TRUE)\nhist(portfolio5, breaks = 6, prob = TRUE)\nhist(portfolio6, breaks = 6, prob = TRUE)\nhist(portfolio7, breaks = 6, prob = TRUE)\nhist(portfolio8, breaks = 6, prob = TRUE)\nhist(portfolio9, breaks = 6, prob = TRUE)\nhist(portfolio10, breaks = 6, prob = TRUE)\n",
    "created" : 1489955489740.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4051782020",
    "id" : "5A3993B7",
    "lastKnownWriteTime" : 1489955497,
    "last_content_update" : 1489955497989,
    "path" : "~/WQU_CASE_STUDY_2/CS2.R",
    "project_path" : "CS2.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}